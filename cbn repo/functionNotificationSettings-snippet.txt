opacity-50\"\n      },\n      adding ? \"Adding...\" : \"Add Member\"\n    )))))));\n  }\n\n  // virtual:/apps/web/src/components/NotificationSettings.jsx\n  init_injected_globals();\n  var import_react66 = __toESM(require_react());\n  var import_lucide_react24 = __toESM(require_lucide_react());\n  function NotificationSettings() {\n    const [loading, setLoading] = (0, import_react66.useState)(true);\n    const [saving, setSaving] = (0, import_react66.useState)(false);\n    const [sendingTest, setSendingTest] = (0, import_react66.useState)(false);\n    const [checkingReminders, setCheckingReminders] = (0, import_react66.useState)(false);\n    const [testMessage, setTestMessage] = (0, import_react66.useState)(null);\n    const [reminderResults, setReminderResults] = (0, import_react66.useState)(null);\n    const [settingUpWebhook, setSettingUpWebhook] = (0, import_react66.useState)(false);\n    const [webhookStatus, setWebhookStatus] = (0, import_react66.useState)(null);\n    const [preferences, setPreferences] = (0, import_react66.useState)({\n      email_enabled: true,\n      sms_enabled: false,\n      telegram_enabled: false,\n      reminder_time_value: 1,\n      reminder_time_unit: \"hours\",\n      email_address: \"\",\n      phone_number: \"\",\n      sound_enabled: true\n    });\n    const [chatIds, setChatIds] = (0, import_react66.useState)([]);\n    const [loadingChatIds, setLoadingChatIds] = (0, import_react66.useState)(true);\n    const [newLabel, setNewLabel] = (0, import_react66.useState)(\"\");\n    const [newChatId, setNewChatId] = (0, import_react66.useState)(\"\");\n    const [addingChatId, setAddingChatId] = (0, import_react66.useState)(false);\n    const [sendingTestTelegram, setSendingTestTelegram] = (0, import_react66.useState)(null);\n    (0, import_react66.useEffect)(() =\u003e {\n      fetchPreferences();\n      fetchChatIds();\n    }, []);\n    const fetchPreferences = async () =\u003e {\n      try {\n        const response = await fetch(\"/api/admin/notification-preferences\");\n        if (!response.ok) throw new Error(\"Failed to fetch preferences\");\n        const data = await response.json();\n        setPreferences(data.preferences);\n      } catch (err) {\n        console.error(\"Error fetching preferences:\", err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    const fetchChatIds = async () =\u003e {\n      try {\n        const response = await fetch(\"/api/admin/telegram-chat-ids\");\n        if (!response.ok) throw new Error(\"Failed to fetch chat IDs\");\n        const data = await response.json();\n        setChatIds(data.chatIds || []);\n      } catch (err) {\n        console.error(\"Error fetching chat IDs:\", err);\n      } finally {\n        setLoadingChatIds(false);\n      }\n    };\n    const handleAddChatId = async () =\u003e {\n      if (!newLabel.trim() || !newChatId.trim()) return;\n      setAddingChatId(true);\n      try {\n        const response = await fetch(\"/api/admin/telegram-chat-ids\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            label: newLabel.trim(),\n            chat_id: newChatId.trim()\n          })\n        });\n        if (!response.ok) throw new Error(\"Failed to add chat ID\");\n        const data = await response.json();\n        setChatIds((prev) =\u003e [...prev, data.chatId]);\n        setNewLabel(\"\");\n        setNewChatId(\"\");\n      } catch (err) {\n        console.error(\"Error adding chat ID:\", err);\n        setTestMessage({ type: \"error\", text: \"Failed to add Telegram chat ID\" });\n      } finally {\n        setAddingChatId(false);\n      }\n    };\n    const handleToggleChatId = async (id, currentActive) =\u003e {\n      try {\n        const response = await fetch(\"/api/admin/telegram-chat-ids\", {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ id, is_active: !currentActive })\n        });\n        if (!response.ok) throw new Error(\"Failed to toggle\");\n        setChatIds(\n          (prev) =\u003e prev.map(\n            (c) =\u003e c.id === id ? { ...c, is_active: !currentActive } : c\n          )\n        );\n      } catch (err) {\n        console.error(\"Error toggling chat ID:\", err);\n      }\n    };\n    const handleDeleteChatId = async (id) =\u003e {\n      try {\n        const response = await fetch(`/api/admin/telegram-chat-ids?id=${id}`, {\n          method: \"DELETE\"\n        });\n        if (!response.ok) throw new Error(\"Failed to delete\");\n        setChatIds((prev) =\u003e prev.filter((c) =\u003e c.id !== id));\n      } catch (err) {\n        console.error(\"Error deleting chat ID:\", err);\n      }\n    };\n    const handleTestTelegram = async (chatId, label) =\u003e {\n      setSendingTestTelegram(chatId);\n      try {\n        const response = await fetch(\"/api/telegram/send\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            chatId,\n            text: \"\\u2705 Test message from CBN Ads Manager! Telegram notifications are working.\"\n          })\n        });\n        const data = await response.json();\n        if (!response.ok) throw new Error(data.error || \"Failed to send test\");\n        setTestMessage({\n          type: \"success\",\n          text: `Test message sent to \"${label}\"!`\n        });\n      } catch (err) {\n        setTestMessage({\n          type: \"error\",\n          text: `Failed to send to \"${label}\": ${err.message}`\n        });\n      } finally {\n        setSendingTestTelegram(null);\n      }\n    };\n    const handleSetupWebhook = async () =\u003e {\n      setSettingUpWebhook(true);\n      setWebhookStatus(null);\n      try {\n        const response = await fetch(\"/api/telegram/setup-webhook\", {\n          method: \"POST\"\n        });\n        const data = await response.json();\n        if (!response.ok)\n          throw new Error(data.error || \"Failed to setup webhook\");\n        setWebhookStatus({\n          type: \"success\",\n          text: \"Telegram webhook registered! Approve/Reject buttons will now work in Telegram.\"\n        });\n      } catch (err) {\n        console.error(\"Error setting up webhook:\", err);\n        setWebhookStatus({\n          type: \"error\",\n          text: `Failed to setup webhook: ${err.message}`\n        });\n      } finally {\n        setSettingUpWebhook(false);\n      }\n    };\n    const handleSave = async () =\u003e {\n      setSaving(true);\n      setTestMessage(null);\n      try {\n        const response = await fetch(\"/api/admin/notification-preferences\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(preferences)\n        });\n        if (!response.ok) throw new Error(\"Failed to save preferences\");\n        setTestMessage({\n          type: \"success\",\n          text: \"Notification preferences saved successfully!\"\n        });\n      } catch (err) {\n        console.error(\"Error saving preferences:\", err);\n        setTestMessage({\n          type: \"error\",\n          text: \"Failed to save preferences. Please try again.\"\n        });\n      } finally {\n        setSaving(false);\n      }\n    };\n    const handleSendTestEmail = async () =\u003e {\n      if (!preferences.email_address) {\n        setTestMessage({\n          type: \"error\",\n          text: \"Please enter an email address first\"\n        });\n        return;\n      }\n      setSendingTest(true);\n      setTestMessage(null);\n      try {\n        const response = await fetch(\"/api/admin/send-test-email\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ email: preferences.email_address })\n        });\n        const data = await response.json();\n        if (!response.ok)\n          throw new Error(data.error || \"Failed to send test email\");\n        setTestMessage({\n          type: \"success\",\n          text: `Test email sent to ${preferences.email_address}! Check your inbox.`\n        });\n      } catch (err) {\n        console.error(\"Error sending test email:\", err);\n        setTestMessage({\n          type: \"error\",\n          text: err.message || \"Failed to send test email. Please check your API key.\"\n        });\n      } finally {\n        setSendingTest(false);\n      }\n    };\n    const handleCheckReminders = async () =\u003e {\n      setCheckingReminders(true);\n      setReminderResults(null);\n      setTestMessage(null);\n      try {\n        const response = await fetch(\"/api/admin/send-reminders\", {\n          method: \"POST\"\n        });\n        const data = await response.json();\n        if (!response.ok)\n          throw new Error(data.error || \"Failed to check reminders\");\n        setReminderResults(data);\n        if (data.totalResults === 0) {\n          setTestMessage({\n            type: \"info\",\n            text: \"No reminders due at this time. Check console logs for details.\"\n          });\n        } else {\n          setTestMessage({\n            type: \"success\",\n            text: `Processed ${data.totalResults} reminder(s). See results below.`\n          });\n        }\n      } catch (err) {\n        console.error(\"Error checking reminders:\", err);\n        setTestMessage({\n          type: \"error\",\n          text: err.message || \"Failed to check reminders.\"\n        });\n      } finally {\n        setCheckingReminders(false);\n      }\n    };\n    if (loading) {\n      return /* @__PURE__ */ React.createElement(\"div\", { className: \"bg-white rounded-lg border border-gray-200 p-6\" }, /* @__PURE__ */ React.createElement(\"p\", { className: \"text-gray-600\" }, \"Loading preferences...\"));\n    }\n    const activeChatCount = chatIds.filter((c) =\u003e c.is_active).length;\n    return /* @__PURE__ */ React.createElement(\"div\", { className: \"space-y-6\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"bg-white rounded-lg border border-gray-200\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"p-6 border-b border-gray-200\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center gap-3 mb-2\" }, /* @__PURE__ */ React.createElement(import_lucide_react24.Bell, { size: 20, className: \"text-gray-700\" }), /* @__PURE__ */ React.createElement(\"h2\", { className: \"text-lg font-semibold text-gray-900\" }, \"Reminder Timing\")), /* @__PURE__ */ React.createElement(\"p\", { className: \"text-sm text-gray-500\" }, \"Set when you want to be notified before an ad is due\")), /* @__PURE__ */ React.createElement(\"div\", { className: \"p-6\" }, /* @__PURE__ */ React.createElement(\"label\", { className: \"block text-sm font-medium text-gray-700 mb-3\" }, \"Notify me\"), /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center gap-3\" }, /* @__PURE__ */ React.createElement(\n      \"input\",\n      {\n        type: \"number\",\n        min: \"1\",\n        value: preferences.reminder_time_value,\n        onChange: (e) =\u003e setPreferences({\n          ...preferences,\n          reminder_time_value: parseInt(e.target.value) || 1\n        }),\n        className: \"w-24 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900\"\n      }\n    ), /* @__PURE__ */ React.createElement(\n      \"select\",\n      {\n        value: preferences.reminder_time_unit,\n        onChange: (e) =\u003e setPreferences({\n          ...preferences,\n          reminder_time_unit: e.target.value\n        }),\n        className: \"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900\"\n      },\n      /* @__PURE__ */ React.createElement(\"option\", { value: \"minutes\" }, \"minutes\"),\n      /* @__PURE__ */ React.createElement(\"option\", { value: \"hours\" }, \"hours\"),\n      /* @__PURE__ */ React.createElement(\"option\", { value: \"days\" }, \"days\")\n    ), /* @__PURE__ */ React.createElement(\"span\", { className: \"text-sm text-gray-600\" }, \"before an ad is due\")), /* @__PURE__ */ React.createElement(\"p\", { className: \"text-xs text-gray-500 mt-3\" }, \"This applies to email, SMS, and Telegram notifications\"))), /* @__PURE__ */ React.createElement(\"div\", { className: \"bg-white rounded-lg border border-gray-200\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"p-6 border-b border-gray-200\" }, /* @__PURE__ */ React.createElement(\"h2\", { className: \"text-lg font-semibold text-gray-900\" }, \"Notification Channels\"), /* @__PURE__ */ React.createElement(\"p\", { className: \"text-sm text-gray-500 mt-1\" }, \"Choose how you want to receive notifications\")), /* @__PURE__ */ React.createElement(\"div\", { className: \"divide-y divide-gray-200\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"p-6\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-start gap-4\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center justify-center w-10 h-10 bg-gray-100 rounded-lg flex-shrink-0\" }, /* @__PURE__ */ React.createElement(import_lucide_react24.Mail, { size: 20, className: \"text-gray-600\" })), /* @__PURE__ */ React.createElement(\"div\", { className: \"flex-1 min-w-0\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center justify-between mb-2\" }, /* @__PURE__ */ React.createElement(\"div\", null, /* @__PURE__ */ React.createElement(\"h3\", { className: \"text-sm font-medium text-gray-900\" }, \"Email Notifications\"), /* @__PURE__ */ React.createElement(\"p\", { className: \"text-sm text-gray-500 mt-0.5\" }, \"Receive email reminders for upcoming ads\")), /* @__PURE__ */ React.createElement(\n      \"button\",\n      {\n        onClick: () =\u003e setPreferences({\n          ...preferences,\n          email_enabled: !preferences.email_enabled\n        }),\n        className: `relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${preferences.email_enabled ? \"bg-gray-900\" : \"bg-gray-200\"}`\n      },\n      /* @__PURE__ */ React.createElement(\n        \"span\",\n        {\n          className: `inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${preferences.email_enabled ? \"translate-x-6\" : \"translate-x-1\"}`\n        }\n      )\n    )), preferences.email_enabled \u0026\u0026 /* @__PURE__ */ React.createElement(\"div\", { className: \"mt-4\" }, /* @__PURE__ */ React.createElement(\"label\", { className: \"block text-sm font-medium text-gray-700 mb-2\" }, \"Email Address\"), /* @__PURE__ */ React.createElement(\n      \"input\",\n      {\n        type: \"email\",\n        placeholder: \"admin@example.com\",\n        value: preferences.email_address,\n        onChange: (e) =\u003e setPreferences({\n          ...preferences,\n          email_address: e.target.value\n        }),\n        className: \"w-full max-w-md px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900\"\n      }\n    ))))), /* @__PURE__ */ React.createElement(\"div\", { className: \"p-6\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-start gap-4\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center justify-center w-10 h-10 bg-gray-100 rounded-lg flex-shrink-0\" }, /* @__PURE__ */ React.createElement(import_lucide_react24.Send, { size: 20, className: \"text-gray-600\" })), /* @__PURE__ */ React.createElement(\"div\", { className: \"flex-1 min-w-0\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center justify-between mb-2\" }, /* @__PURE__ */ React.createElement(\"div\", null, /* @__PURE__ */ React.createElement(\"h3\", { className: \"text-sm font-medium text-gray-900\" }, \"Telegram Notifications\"), /* @__PURE__ */ React.createElement(\"p\", { className: \"text-sm text-gray-500 mt-0.5\" }, \"Send reminders with media to Telegram\")), /* @__PURE__ */ React.createElement(\n      \"button\",\n      {\n        onClick: () =\u003e setPreferences({\n          ...preferences,\n          telegram_enabled: !preferences.telegram_enabled\n        }),\n        className: `relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${preferences.telegram_enabled ? \"bg-gray-900\" : \"bg-gray-200\"}`\n      },\n      /* @__PURE__ */ React.createElement(\n        \"span\",\n        {\n          className: `inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${preferences.telegram_enabled ? \"translate-x-6\" : \"translate-x-1\"}`\n        }\n      )\n    )), preferences.telegram_enabled \u0026\u0026 /* @__PURE__ */ React.createElement(\"div\", { className: \"mt-4 space-y-4\" }, /* @__PURE__ */ React.createElement(\"div\", null, /* @__PURE__ */ React.createElement(\"label\", { className: \"block text-sm font-medium text-gray-700 mb-2\" }, \"Chat IDs\", \" \", /* @__PURE__ */ React.createElement(\"span\", { className: \"text-gray-400 font-normal\" }, \"(\", activeChatCount, \" active)\")), loadingChatIds ? /* @__PURE__ */ React.createElement(\"p\", { className: \"text-sm text-gray-400\" }, \"Loading...\") : chatIds.length === 0 ? /* @__PURE__ */ React.createElement(\"div\", { className: \"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center\" }, /* @__PURE__ */ React.createElement(\"p\", { className: \"text-sm text-gray-500\" }, \"No Telegram chat IDs added yet\")) : /* @__PURE__ */ React.createElement(\"div\", { className: \"space-y-2 mb-4\" }, chatIds.map((item) =\u003e /* @__PURE__ */ React.createElement(\n      \"div\",\n      {\n        key: item.id,\n        className: `flex items-center gap-3 px-3 py-2.5 rounded-lg border transition-colors ${item.is_active ? \"bg-white border-gray-200\" : \"bg-gray-50 border-gray-200 opacity-50\"}`\n      },\n      /* @__PURE__ */ React.createElement(\n        \"button\",\n        {\n          onClick: () =\u003e handleToggleChatId(item.id, item.is_active),\n          className: `flex items-center justify-center w-5 h-5 rounded border-2 transition-colors ${item.is_active ? \"bg-gray-900 border-gray-900\" : \"bg-white border-gray-300\"}`\n        },\n        item.is_active \u0026\u0026 /* @__PURE__ */ React.createElement(import_lucide_react24.Check, { size: 14, className: \"text-white\" })\n      ),\n      /* @__PURE__ */ React.createElement(\"div\", { className: \"flex-1 min-w-0\" }, /* @__PURE__ */ React.createElement(\"p\", { className: \"text-sm font-medium text-gray-900 truncate\" }, item.label), /* @__PURE__ */ React.createElement(\"p\", { className: \"text-xs text-gray-500 font-mono\" }, item.chat_id)),\n      /* @__PURE__ */ React.createElement(\n        \"button\",\n        {\n          onClick: () =\u003e handleTestTelegram(item.chat_id, item.label),\n          disabled: sendingTestTelegram === item.chat_id,\n          className: \"px-2.5 py-1.5 text-xs font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50 transition-colors\"\n        },\n        sendingTestTelegram === item.chat_id ? \"Sending...\" : \"Test\"\n      ),\n      /* @__PURE__ */ React.createElement(\n        \"button\",\n        {\n          onClick: () =\u003e handleDeleteChatId(item.id),\n          className: \"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors\"\n        },\n        /* @__PURE__ */ React.createElement(import_lucide_react24.Trash2, { size: 14 })\n      )\n    ))), /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-end gap-2\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex-1\" }, /* @__PURE__ */ React.createElement(\n      \"input\",\n      {\n        type: \"text\",\n        placeholder: \"Label (e.g. John, Sales Team)\",\n        value: newLabel,\n        onChange: (e) =\u003e setNewLabel(e.target.value),\n        className: \"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900\"\n      }\n    )), /* @__PURE__ */ React.createElement(\"div\", { className: \"flex-1\" }, /* @__PURE__ */ React.createElement(\n      \"input\",\n      {\n        type: \"text\",\n        placeholder: \"Chat ID (e.g. 8751400670)\",\n        value: newChatId,\n        onChange: (e) =\u003e setNewChatId(e.target.value),\n        className: \"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900\"\n      }\n    )), /* @__PURE__ */ React.createElement(\n      \"button\",\n      {\n        onClick: handleAddChatId,\n        disabled: addingChatId || !newLabel.trim() || !newChatId.trim(),\n        className: \"px-3 py-2 bg-gray-900 text-white text-sm font-medium rounded-lg hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-1.5\"\n      },\n      /* @__PURE__ */ React.createElement(import_lucide_react24.Plus, { size: 14 }),\n      addingChatId ? \"Adding...\" : \"Add\"\n    )), /* @__PURE__ */ React.createElement(\"p\", { className: \"text-xs text-gray-500 mt-2\" }, \"Message \", /* @__PURE__ */ React.createElement(\"strong\", null, \"@userinfobot\"), \" on Telegram to find your chat ID\"), /* @__PURE__ */ React.createElement(\"div\", { className: \"mt-6 pt-4 border-t border-gray-200\" }, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center justify-between\" }, /* @__PURE__ */ React.createElement(\"div\", null, /* @__PURE__ */ React.createElement(\"div\", { className: \"flex items-center gap-2\" }, /* @__PURE__ */ React.createElement(import_lucide_react24.Link, { size:
